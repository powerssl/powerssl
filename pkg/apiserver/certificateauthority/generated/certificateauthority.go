// Code generated by protoc-gen-gotemplate. DO NOT EDIT.

package certificateauthority // import "powerssl.io/pkg/apiserver/certificateauthority/generated"

import (
	"github.com/go-kit/kit/log"
	"github.com/go-kit/kit/metrics"
	"github.com/jinzhu/gorm"
	"google.golang.org/grpc"

	apiv1 "powerssl.io/pkg/apiserver/api/v1"
	service "powerssl.io/pkg/apiserver/certificateauthority"
	"powerssl.io/pkg/apiserver/certificateauthority/generated/endpoint"
	"powerssl.io/pkg/apiserver/certificateauthority/generated/transport"
	controllerclient "powerssl.io/pkg/controller/client"
)

type CertificateAuthority struct {
	endpoints endpoint.Endpoints
	logger    log.Logger
}

func New(db *gorm.DB, logger log.Logger, duration metrics.Histogram, client *controllerclient.GRPCClient) *CertificateAuthority {
	svc := service.New(db, logger, client)
	endpoints := endpoint.NewEndpoints(svc, logger, duration)

	return &CertificateAuthority{
		endpoints: endpoints,
		logger:    logger,
	}
}

func (certificateAuthority *CertificateAuthority) RegisterGRPCServer(baseServer *grpc.Server) {
	grpcServer := transport.NewGRPCServer(certificateAuthority.endpoints, certificateAuthority.logger)
	apiv1.RegisterCertificateAuthorityServiceServer(baseServer, grpcServer)
}
